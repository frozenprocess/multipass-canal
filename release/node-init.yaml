package_update: true
packages:
  - conntrack
ssh_keys:
  rsa_private: |
    -----BEGIN RSA PRIVATE KEY-----
    MIIEowIBAAKCAQEAr1tnUS7tDy0HkOauV++kWj74fP5YYU87nHTos4MyX21Apb3u
    ClQor7Qdf0tK1+rrmS+k2YbUQ6wdW1RgJMJ7es00/4q0NZctQLHiwBiHQPtN4pEO
    IA9YS/jD1EZKODvalsg6Qcz7Y4p0ZF2Ez3Q3t4OY49QmTCPLsPqDsHcX//Xn3hH4
    kGfqWbqoLRCbbcVsdzay6osmYYnIklaEccl5DpbTHaL8zXnnkQdCpBSoY0loY01t
    EESdfWbA7R95cQoUHe2BX07WC9KHt2ZESDcx8H69b801WqJVkxe9B+C1hWk2aZhV
    mflpplza4lB8KL9kwbAmETACZDO9jwIvFprVkQIDAQABAoIBAGGevNGREh+UrdWY
    1g3WNuSWkbbj0Ue62DCtVK46p1xAcfDS3yWY3F2UI6etvqic+zN4NolyadCSjHU/
    b5aHPj6K5qosCU6cLnEJlnXiMcmXHTC4F+j5IeqJPlt6Fe9gQrwWE3h2KKytc0Y8
    Waczx6C9/es3O2q/srF/hLhEVHQFAUzVQ0VAYdHZUcWgrTRtCi+etXaYssXLbuH/
    R0UVb4qctEHRbE9LwLOG8u7o+xC9xYnmMUKAKgyEwwYIR5F1kR3Ebl/cx10owfqV
    YhF7V3hbpAbNUdsdhG/Wv3Q3pRFzz3hRGQpfFPG1PINpf3j5oGTbMzdxuT6ddbq+
    1wNsWcECgYEA3HXqkoRx5bSvIMhrOQJmrXjxo5ecWfa8sLohJJYkka9G3TprA4fy
    9p1IbPgkzDO0RQmCxKQt3Z7OC5mk1owevpF+sJEEFYKhRdOoS8u3VONp6vWUikVc
    hdpeWAOWOc7tiYMyew6+NprBNF2YbgnRnNXdErfGYGt4p2+Yn19+jIUCgYEAy6Ah
    OR8pTaGu2p6WYHJtYPa90zHwVSSBcpNREVoNrIPo/YEOZDPCnKTEX+rHoEdSS1lC
    n2E3hytP7vv/sPGRz2R7h2+2Off47smdt4wJ6zoioOTPjWnCUfix4Kjay5WGswSJ
    tsMVe2WTaUV/bG/d23du4CLmVHnZOmJK0Ml4iJ0CgYBCBgJhLM8bdvg3vi32XdS4
    QQ9E6gPGIZGy75s7ZMfA5Zg4auVfolhOKR5mnA4RJa7oOgfysiSWSZf1e2cVZdNT
    SSmC4XsyofOAgPnW8USPZKf02OVKX6ls4M/+VdyopWMYGrWEiw7GNaSE9T7QPZqL
    +LSDhYwgli8FHfO8TxIMLQKBgQCv5frtIjsGwcWPOvGCDTbpTRw7pWcL1cYw2Itu
    JtGrFiQdYO+ypXfW4wp0JRcfIJ05U7kWft99129sbam6C2O+uPlwzJKozsnuVKH2
    nXUwCv9A54dXjGV9dA0MmjCvLtK2MBRamXkkKGHHzW4+mQAYhrpzyhIYJU3+fkxM
    wc1qjQKBgF7erwUBI5zt+vPcurh/pANDWuEOz1zqBr3svqXytI8UvySuHP9qfHY0
    JLdAyiMNRolMOEVe7umTbB95DifK7DqK2bTw9jrtUdOJ18G5cTf3+pv8NZKCg0B8
    56E90uQJS9aJ/qVZiubWiZpFuIX2tqjulqpp9aN3NbA/Uv8YJa78
    -----END RSA PRIVATE KEY-----

  rsa_public: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCvW2dRLu0PLQeQ5q5X76RaPvh8/lhhTzucdOizgzJfbUClve4KVCivtB1/S0rX6uuZL6TZhtRDrB1bVGAkwnt6zTT/irQ1ly1AseLAGIdA+03ikQ4gD1hL+MPURko4O9qWyDpBzPtjinRkXYTPdDe3g5jj1CZMI8uw+oOwdxf/9efeEfiQZ+pZuqgtEJttxWx3NrLqiyZhiciSVoRxyXkOltMdovzNeeeRB0KkFKhjSWhjTW0QRJ19ZsDtH3lxChQd7YFfTtYL0oe3ZkRINzHwfr1vzTVaolWTF70H4LWFaTZpmFWZ+WmmXNriUHwov2TBsCYRMAJkM72PAi8WmtWR calico@cloud

write_files:
- encoding: b64
  content: IyEvYmluL2Jhc2gKCktVQkVSTkVURVNfVkVSU0lPTj0xLjIzLjkKQ0lEUj0xNzIuMTYuMC4wCkNPTlRBSU5FUkQ9MS42LjE4ClJVTkM9MS4xLjQKQ05JX1BMVUdJTj0xLjEuMQoKY2F0IDw8RU9GIHwgc3VkbyB0ZWUgL2V0Yy9tb2R1bGVzLWxvYWQuZC9rOHMuY29uZgpvdmVybGF5CmJyX25ldGZpbHRlcgpFT0YKCnN1ZG8gbW9kcHJvYmUgb3ZlcmxheQpzdWRvIG1vZHByb2JlIGJyX25ldGZpbHRlcgoKIyBzeXNjdGwgcGFyYW1zIHJlcXVpcmVkIGJ5IHNldHVwLCBwYXJhbXMgcGVyc2lzdCBhY3Jvc3MgcmVib290cwpjYXQgPDxFT0YgfCBzdWRvIHRlZSAvZXRjL3N5c2N0bC5kL2s4cy5jb25mCm5ldC5icmlkZ2UuYnJpZGdlLW5mLWNhbGwtaXB0YWJsZXMgID0gMQpuZXQuYnJpZGdlLmJyaWRnZS1uZi1jYWxsLWlwNnRhYmxlcyA9IDEKbmV0LmlwdjQuaXBfZm9yd2FyZCAgICAgICAgICAgICAgICAgPSAxCkVPRgoKIyBBcHBseSBzeXNjdGwgcGFyYW1zIHdpdGhvdXQgcmVib290CnN1ZG8gc3lzY3RsIC0tc3lzdGVtCgpzeXNjdGwgbmV0LmJyaWRnZS5icmlkZ2UtbmYtY2FsbC1pcHRhYmxlcyBuZXQuYnJpZGdlLmJyaWRnZS1uZi1jYWxsLWlwNnRhYmxlcyBuZXQuaXB2NC5pcF9mb3J3YXJkCgoKY3VybCAtT0wgaHR0cHM6Ly9naXRodWIuY29tL2NvbnRhaW5lcmQvY29udGFpbmVyZC9yZWxlYXNlcy9kb3dubG9hZC92JENPTlRBSU5FUkQvY29udGFpbmVyZC0kQ09OVEFJTkVSRC1saW51eC1hbWQ2NC50YXIuZ3oKdGFyIEN4enZmIC91c3IvbG9jYWwgY29udGFpbmVyZC0kQ09OVEFJTkVSRC1saW51eC1hbWQ2NC50YXIuZ3oKCm1rZGlyIC1wIC91c3IvbG9jYWwvbGliL3N5c3RlbWQvc3lzdGVtLwpjdXJsIC1MIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jb250YWluZXJkL2NvbnRhaW5lcmQvbWFpbi9jb250YWluZXJkLnNlcnZpY2UgLW8gL3Vzci9sb2NhbC9saWIvc3lzdGVtZC9zeXN0ZW0vY29udGFpbmVyZC5zZXJ2aWNlCgpzeXN0ZW1jdGwgZGFlbW9uLXJlbG9hZApzeXN0ZW1jdGwgZW5hYmxlIC0tbm93IGNvbnRhaW5lcmQKCmN1cmwgLU9MIGh0dHBzOi8vZ2l0aHViLmNvbS9vcGVuY29udGFpbmVycy9ydW5jL3JlbGVhc2VzL2Rvd25sb2FkL3YkUlVOQy9ydW5jLmFtZDY0Cmluc3RhbGwgLW0gNzU1IHJ1bmMuYW1kNjQgL3Vzci9sb2NhbC9zYmluL3J1bmMKCmN1cmwgLU9MIGh0dHBzOi8vZ2l0aHViLmNvbS9jb250YWluZXJuZXR3b3JraW5nL3BsdWdpbnMvcmVsZWFzZXMvZG93bmxvYWQvdiRDTklfUExVR0lOL2NuaS1wbHVnaW5zLWxpbnV4LWFtZDY0LXYkQ05JX1BMVUdJTi50Z3oKbWtkaXIgLXAgL29wdC9jbmkvYmluCnRhciBDeHp2ZiAvb3B0L2NuaS9iaW4gY25pLXBsdWdpbnMtbGludXgtYW1kNjQtdiRDTklfUExVR0lOLnRnegoKc3lzdGVtY3RsIHJlc3RhcnQgY29udGFpbmVyZAoKbWtkaXIgL2V0Yy9jb250YWluZXJkCiMgQ2dyb3VwIGJhYnkKY29udGFpbmVyZCBjb25maWcgZGVmYXVsdCB8IHNlZCAncy9TeXN0ZW1kQ2dyb3VwID0gZmFsc2UvU3lzdGVtZENncm91cCA9IHRydWUvJyA+IC9ldGMvY29udGFpbmVyZC9jb25maWcudG9tbAoKc3lzdGVtY3RsIHJlc3RhcnQgY29udGFpbmVyZAoKbWtkaXIgLXAgL2V0Yy9hcHQva2V5cmluZ3MvCmN1cmwgLWZzU0xvIC9ldGMvYXB0L2tleXJpbmdzL2t1YmVybmV0ZXMtYXJjaGl2ZS1rZXlyaW5nLmdwZyBodHRwczovL3BhY2thZ2VzLmNsb3VkLmdvb2dsZS5jb20vYXB0L2RvYy9hcHQta2V5LmdwZwplY2hvICJkZWIgW3NpZ25lZC1ieT0vZXRjL2FwdC9rZXlyaW5ncy9rdWJlcm5ldGVzLWFyY2hpdmUta2V5cmluZy5ncGddIGh0dHBzOi8vYXB0Lmt1YmVybmV0ZXMuaW8vIGt1YmVybmV0ZXMteGVuaWFsIG1haW4iIHwgc3VkbyB0ZWUgL2V0Yy9hcHQvc291cmNlcy5saXN0LmQva3ViZXJuZXRlcy5saXN0CgphcHQtZ2V0IHVwZGF0ZQphcHQtZ2V0IGluc3RhbGwgLXkga3ViZWxldD0kS1VCRVJORVRFU19WRVJTSU9OLTAwIGt1YmVhZG09JEtVQkVSTkVURVNfVkVSU0lPTi0wMCBrdWJlY3RsPSRLVUJFUk5FVEVTX1ZFUlNJT04tMDAganEKCmFwdC1tYXJrIGhvbGQga3ViZWxldCBrdWJlYWRtIGt1YmVjdGwKCm1rZGlyIC9yb290Ly5rdWJlLwo=
  owner: root:root
  path: /root/prepare.sh
- encoding: b64
  content: IyEvYmluL2Jhc2gKCiMgV2FpdCBmb3IgaXQKd2hpbGUgW1sgJChjdXJsIC0td3JpdGUtb3V0ICcle2h0dHBfY29kZX0nIC0tc2lsZW50IC0tb3V0cHV0IC9kZXYvbnVsbCBjb250cm9sLm11bHRpcGFzczo2NDQzKSAhPSAiNDAwIiBdXQpkbwogICAgZWNobyAiV2FpdGluZyBmb3IgY29udHJvbCIKICAgIHNsZWVwIDEKZG9uZQoKCi91c3IvYmluL3NjcCAtaSAiL2V0Yy9zc2gvc3NoX2hvc3RfcnNhX2tleSIgLW8gU3RyaWN0SG9zdEtleUNoZWNraW5nPW5vIHJvb3RAY29udHJvbC5tdWx0aXBhc3M6L3Jvb3Qvam9pbi5zaCAvcm9vdC9qb2luLnNoCmNobW9kICt4IC9yb290L2pvaW4uc2gKL3Jvb3Qvam9pbi5zaAo=
  owner: root:root
  path: /root/node.sh

runcmd:
  - [ /usr/bin/chmod, +x, /root/prepare.sh ]
  - [ /root/prepare.sh ]
  - [ /usr/bin/chmod, +x, /root/node.sh ]
  - [ /root/node.sh ]
  - [ /usr/bin/chown, -R, ubuntu:ubuntu, /home/ubuntu ]

power_state:
  mode: reboot
